%\setchapterpreamble[uc][0.8\textwidth]{%
%	\dictum[George Bernard Shaw]{%
%		``It is the mark of a truly intelligent person to be moved by statistics.''}\vskip20em}
	
%\setchapterpreamble[uc][0.8\textwidth]{%
%			\dictum[George Bernard Shaw]{%
%				``Science never solves a problem without creating ten more.''}\vskip20em}
			
\setchapterpreamble[uc][0.8\textwidth]{%
	\dictum[Han Solo]{%
		``She may not look like much, but she's got it where it counts.''}\vskip20em}			
	

	
\chapter{General Introduction}
\label{chap:intro}
\newpage

%------------------------------------------------------------------------------------------------%
% ---------------------------- History and state of the art------------------------------------- %
\section{History and state of the art of forest inventory}
\label{sec:intro:hist_soa}


% end with: A conclusion from recent developments is that future forest planning methods will increasingly integrate information of auxiliary data such as remote sensing and geo data. 

\newpage
%------------------------------------------------------------------------------------------------%
% ---------------------------------- Goals ----------------------------------------------------- %
\section{Thesis objective and structure}
\label{sec:intro:obj_and_struct}

The objective of this thesis was to contribute methodologies to the recent developments in combining existing forest inventory data from field surveys with auxiliary data, such as those derived from remote sensing data. The particular focus was thereby on investigating the potential increase in value of already existing large scale terrestrial forest inventories to be used on small-scale management levels. The main question of this thesis to be addressed was: what estimation accuracies can be realized using forest inventory data on much smaller spatial levels as their sampling intensities have originally been designed for? This question was investigated in two main studies: The first study \hyperref[sec:study1]{(study 1)} constitutes the main part of this thesis and concentrated on exploring the capabilities and performances of design-based multi-phase regression estimators in the service of small area estimation. The second study \hyperref[sec:study2]{(study 2)} investigated a new approach for evaluating the estimation accuracies of forest attribute maps, which are considered to be a special case of small area estimation. The following subsections will give a more detailed introduction to each of the studies.


% --------------------------------- %
% --------------------------------- %
\subsection{Study 1: Design-based small area estimation}
\label{sec:study1}

% ############################################################
% ## ===== general information on study 1 (RLP SAEs) ====== ##

This study constituted the major work of the thesis and had the objective to develop and evaluate a double-sampling estimation procedure for the German National Forest Inventory (German NFI). The particular objective of the study was to investigate whether the German NFI data can provide acceptable estimation precision on two forest district levels when incorporated in small area estimation procedures. Similar studies have been conducted in Norway \citep{breidenbach2012} and Switzerland \citep{magnussen2014a, steinmann2013}, but no extensive study had yet been available for Germany. The results from this study were considered to provide valuable evidence whether a double-sampling extension of the German NFI might be a cost-saving alternative to a regional terrestrial forest district inventory (FDI). It was thus a prerequisite to gather information for a sufficiently large number of small area units in order to allow for reliable conclusions. For this reason, we conducted a study in the German federal state Rhineland-Palatinate (RLP) where we extended the German NFI to a double-sampling design and applied three types of small area regression estimators in order to derive point and variance estimates of mean standing timber volume on two forest district levels comprising 45 and 405 units respectively.\par

In this framework, we decided to particularly explore the performances of design-based regression estimators in the infinite population approach. Methods for this family of estimators have considerably been contributed to by the works of \citet{mandallaz2008, mandallaz2013a, mandallaz2013c} and \citet{mandallaz2013b}, and applications of the suggested regression estimators for global estimations have been intensively investigated by \citet{massey2015_thesis}. Thus, our study was also a continuation in the application of these estimators for the special case of small area estimation. The design-based double-sampling estimators suggested by Mandallaz were also favored for the following reasons: First, the estimators are explicitly formulated for cluster sampling designs such as applied in the German NFI, which has not yet been the case for frequently used model-dependent estimators. Second, the design-based frame considerably relaxes requirements on the regression model which seemed appropriate facing severe quality restrictions in the auxiliary data of the study area. Third, the estimators provide the asymptotically unbiased g-weight variance estimator which a) accounts for the design-dependency of the regression coefficients on the sample under the commonly applied \textit{internal model approach}, and b) is also robust to heteroscedasticity of model residuals.\par

The conduction of this study was divided into 3 work packages that each addressed major milestones towards the overall study objective. The work and results of these work packages are respectively presented in chapter \ref{chap:rpack}, chapter \ref{chap:regmod} and chapter \ref{chap:sae} and have also been published in or submitted to scientific peer-reviewed journals. In the following, we will give an introduction and some additional background information to each of these chapters.


% ---------------------- %
% ---------------------- %
\subsubsection{Work Package 1: Software implementation} % Chapter 2

% ----------------------------------------------
% # --- Chapter 2: Software implementation --- #

With respect to the study objective, work package 1 addressed the need of a robust and flexible software implementation of the design-based regression estimators that could handle large inventory data sets and process a large number of small area estimations at once. Whereas several of the estimators suggested by Mandallaz had been applied in simulations and real-world case studies \citep{mandallaz2013a, mandallaz2013b, mandallaz2013c, massey2014a, massey2015a, massey2015b}, there had yet not been a unified and consistent implementation of the estimators in the same software environment. The work on this study was thus taken as an opportunity to implement the full range of these regression estimators as a \textit{package} in the statistical software \proglang{R} \citep{R}. The implementation procedure comprised three steps in general: First, a comprehensive review of all published regression estimators by Mandallaz; second, the completion of yet missing estimators for three-phase small area estimation; and third, the actual implementation of the estimators in \proglang{R}. The latter seemed to be the software of choice, as it constitutes one of the most intensively used statistical softwares and also provides interfaces to data base systems in which inventory and geodata are commonly stored. A review of existing software for multi-stage and multi-phase estimation revealed that in comparison to official statistics, applications particularly suited for forest inventories have been rare. Exceptions are the \proglang{R} package \pkg{JoSAE} by \citet{josae2015} and the \pkg{maSAE} package by \citet{cullmann2016}. However, a more comprehensive software package covering a larger variety of sample designs and estimators - particularly in the design-based infinite population frame - has not yet been available. In order to address this lack between availability and recent interest in such methods, we also made our software package freely available as the \proglang{R} package \pkg{forestinventory} that can be installed from the CRAN server (\url{https://CRAN.R-project.org/package=forestinventory}). Chapter \ref{chap:rpack} describes the implementation and the application of the two-phase and three-phase estimators in \proglang{R} and provides a comprehensive review of the design-based regression estimators for global and small area estimation published by \citet{mandallaz2008, mandallaz2013a, mandallaz2013c} and \citet{mandallaz2013b}. The availability of the software package in combination with its comprehensive documentation also had the objective to support the transparency and the reproducibility of the methods applied in this study.


%   - provides a review of all design-based estimators for global and small area estimation published by Mandallaz
%   - describes the implementation of the 2p/3p estimators in the statistical software R
%   - provides consistent framework to process large amount of data (plausibility checks, data intergrity, ...) 
%      objectives / requirements on software:
%      - provides calculation and comparison of the estimators based on the same input dataset
%      - provides summarized, standardized outputs for further analysis and visualization
%      - addresses the lack of available software for design-based estimations in forest inventories
%      - mention documentation: R-help, github, vignette
%      - end with: The availability of the software package in combination with its comprehensive documentation als had the objective to support the transparency and the reproducibility of the methods applied in this thesis.

%% for Discussion:
%   - development of a robust and flexible software application which allowed for the calculation of a comprehensive set of small area regression estimators
%   - the software is - at the moment - the most extensive open-source software for design-based estimation for forestry applications. The interest and need of such software was also indicated by
%     xxx download between the first and second release (maybe put this in Synthesis --> turned out that this software was needed and has widely been recognized ... / and feedback reveived from researchers as well as practioners).


% ---------------------- %
% ---------------------- %
\subsubsection{Work Package 2: Derivation of auxiliary data and modeling} % Chapter 3

%--------------------------------
% # --- Chapter 3: Modeling --- #

The objective of work package 2 was to find a suitable ordinary least square (OLS) regression model to be used as \textit{internal model} in the small area regression estimators. In order to apply the estimators to all management units in RLP, the regression model had to allow for predicting the standing timber volume of a German NFI sample plot at any location over the federal state forest area. This also imposed the restriction on the auxiliary data to be available at the federal state level. A similar large-scale study with the same model purpose had recently been published by \citet{maack2016} for the German federal state of Baden-W{\"u}rttemberg. Likewise in this study, we also derived explanatory variables from country-wide airborne laser scanning (ALS) data, which were in our case however characterized by severe quality variations as well as time gaps of up to 10 years between the acquisition and the terrestrial survey date. Our study thus specifically addressed techniques to improve the performance of ordinary least square regression models under such restricting conditions. Another novelty of our study was the use of tree species information derived from a country-wide tree species classification map as additional explanatory data. The integration of tree species information in timber volume prediction models has often been stated as some of the most promising but often missing and thus not well investigated information \citep{koch2010, white2016}. One yet existing gap of knowledge concerned the effect of species misclassifications on the regression model accuracy. We addressed this question by developing and evaluating a calibration technique for removing a potential bias in the regression coefficients caused by misclassifications in the tree species variable. A third challenge that further increased the complexity of the model selection procedure was to identify optimal extraction areas for the explanatory variables under the variable plot sizes of angle count sampling applied in the German NFI. Besides the modeling-specific aspects, the work on this study basically comprised the integration and storage of both the terrestrial NFI data and the remote sensing data in a PostgreSQL database using a PostGIS extension. The latter allowed for a georelational storage and query of both data sources and provided fast computation of explanatory variables for large data sets.

% - some background info on data handling: - PostgreSQL-Server, PostGIS extension
% - Modeling the 'FI timber volume' based on available auxiliary data
% - basically constitutes the 'data preparation' for the sae-estimations 
% - consistent storage which provides data integrity, relations and flexbility in terms of queries ...
% - sanitize existing data to match requirements of estimators (geo-relational propoerties ...)
% - in this study only modeling on the plot level, an extended evaluation of the model on the cluster level is introduced in chapter 4
%
% - also addressing the question whether the frame of OLS regression models - which the estimators are restricted to if the g-weight variance is desired - provides enough flexibility to model the data


% ---------------------- %
% ---------------------- %
\subsubsection{Work Package 3: Small area estimation} % Chapter 4

% -------------------------------------
% # --- Chapter 4: SAE estimation --- #
%  - basically bringing the work of chapter 2 and chapter 3 together ...
%     -> application of SAE estimations
%   - objective: 1) which est.accuracies are already achievable with the current data (situation)?
%                2) give an idea what accuracies maybe possible with future data 
%
%
%
%
%

\newpage
% --------------------------------- %
% --------------------------------- %
\subsection{Study 2: Mapping} % Chapter 5
\label{sec:study2}

% ###########################################################
% ## ===== general information on study 2 (Mapping) ====== ##

Forest attribute maps provide an area-wide overview of important information such as development stages, tree species or growing conditions and have thus always been of high interest for forest practitioners. For a long time, such maps were exclusively produced by hand and required expensive field visits and visual inspection of aerial photography. This amount of work also hampered a frequent updating of the maps. However, the production of maps (\textit{mapping}) covering large areas has lately been substantially supported by the availability of exhaustive remote sensing data in combination with modeling techniques \citep{brosofske2014}. Especially maps of predicted forest attributes in high resolution are considered to support the spatially precise allocation of management operations such as harvesting. An example is the use of rasterized timber volume prediction maps for the optimal allocation of cable roads in the frame of harvesting in steep slope mountainous terrains \citep{bont2012, bont2015}.\par

Despite the advantages of providing such high-resolution predictions maps, one should however have in mind that the predictions are often made for considerably small spatial units (map pixels). In most cases, the map pixels match the extent of an inventory sample plot on which the prediction model has been calibrated. One can thus interpret mapping as an extreme case of \textit{small area estimation}. Design-based double-sampling estimators for small area estimation (Study 1) provide closed-form variance formulas that allow for quantifying the estimation precision for every small area unit individually by its estimation error and confidence interval. However, these concepts of quantifying the uncertainty cannot be transferred to mapping approaches in the particular case of a small area unit (i.e. map pixel) corresponding to the size of a sample plot. It is thus necessary that similar efforts than for model building are invested in methods that reliably quantify the resulting map accuracies. A common way to characterize the map accuracy is to use metrics such as the coefficient of determination (R$^2$) or cross-validated root mean square error (RMSE), which rather address the overall prediction performance than the accuracy of individual predictions. For this reason, the specification of confidence intervals on pixel level has been stated as an important contribution to map accuracy assessment \citep{mcroberts2010a}.\par

In case of continuous response variables such as standing timber volume, the application of linear regression models allows for providing a confidence region for each prediction (i.e. pixel) based on the \textit{prediction interval} \citep[pp.136--139]{fahrmeir2013}. The objective of the study presented in Chapter \ref{chap:regmod} was to investigate an alternative approach of deriving pixel-wise confidence intervals by applying well-known concepts of accuracy assessment for categorical classification results \citep{congalton2008}. The core of the suggested approach was to define intervals within the range of terrestrial data and their respective model predictions, and subsequently calculate the \textit{user's accuracy} for each of those intervals. The calculated users' accuracies can then be regarded as the confidence levels for the chosen intervals. In this framework, we demonstrate an optimization algorithm (heuristic search method) that - given a pre-defined number of intervals - automatically identifies the interval boundaries with respect to the best possible classification accuracies. The motivation for the development of this method was twofold: First, to provide a map user with the possibility to evaluate the map detail, i.e. number of intervals/classes, in dependence of the realizable prediction accuracies; and second, to allow for identifying intervals of the response variable for which the map produces considerably high or low prediction accuracies.\par 

The suggested methods were applied in a mountainous study site in the canton of Grisons (Switzerland). We used the regional forest district inventory data in combination with data from an airborne laser scanning acquisition to produce a map of the standing timber volume on sample plot level, on which we subsequently applied the developed accuracy assessment. The setup of this study also addressed the overall question of the thesis, i.e. what prediction accuracies can be realized on small spatial scales when using forest inventory data that are only available in comparatively low sampling frequencies.


%% NOTES
% - Mapping of forest attributes has always been of huge interest for forest practicioners.
% - Especially pixelwise (rasterized) maps of predicted forest attributes are considered to allow for spatially precise allocation of management operations such as harvesting etc.
% - Examples for integration of timber volume prediction maps are e.g. the optimal allocation of cable roads for harvesting in steep slope mountaineuous terrain demonstrated by Bont
% - The production of maps covering large areas has been substantially supported by the availablility of exhaustive remote sensing data.
% - Despite the advantages of providing high-resolution pixelated predictions maps, one should have in mind that the predictions are made for considerably small spatial units that often match the extent of a sample plot on which the prediction model has been calibrated. 
% - We thus consider (emphasize that) mapping as an extreme case of small area estimation where the small area basically constitutes the area of a sample plot.
% - Classical double-sampling estimators for small area estimation (such as used in chapter 3) provide closed-form variance formulas that allow for quantifying the estimation precision for every small area unit individually by its estimation error or confidence interval. 
% - These concepts of uncertainty estimation can however not be transferred to mapping approaches, particularly in the extreme case of a small area (i.e. map pixel) corresponding to the size of a sample plot. 
% - It thus appears necessary that similar efforts than for model building should be invested in providing methods to quantify the resulting map accuracies. 
% - A common way to characterize the map accuracy is to use the R$^2$ (coef. of determ.) and the cross-validated RMSE (root mean squared error), which rather address the overall prediction performance than the accuracy for individual predictions. As deriving confidence intervals on pixel level has been stated as an important contribution to map accuracies assessment, one possibility in the frame of linear regression is to use the prediction intervals (Source: Fahrmeier pp. xx - yy).
%
% - Compared to overall accuracy metrics such as RMSE, we consider that individual 'unit/pixel-level' CIs provide a more detailed and realistic idea of the map accuracies and should be preferred.
% - Thus, the objective of our study was to contribute to the range of methods available to provide confidence intervals for each individual pixel of a prediction map.
% -  We investigated an alternative approach of deriving pixelwise confidence intervals by applying well-known concepts of accuracy assessment for categorical classification results (Congalton and Green). The basic idea of our approach is to define intervals in the set of terrestrial data and their respective model predictions which subsequently allow for calculating the user's accuracy for each of these intervals. These intervals and their respective users' accuracies can thus be treated as confidence intervals. In this framework, we demonstrate a new heuristic search method that identifies those intervals with respect to the best possible classification accuracies given a pre-defined resolution of the predictions (i.e. number of classes).

% for discussion:
% - Compared to overall accuracy metrics such as RMSE, we consider that individual 'unit/pixel-level' CIs provide a more detailed and realistic idea of the map accuracies and should be preferred.
% - for discussion: with regard to an integration of sae methods in operation forest management information systems, its has to be considered which auxiliary data are available on a long-term perspective.

